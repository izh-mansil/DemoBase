<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html;charset=utf-8" http-equiv="content-type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.16428"></meta></head><body><font size="2">
<p class="Usual"><strong><font size="3">Обработка предназначена для автоматического форматирования кода модулей и локализации элементов форм конфигурации.</font></strong></p>
<p class="Usual"></p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Работает с файловыми базами, серверными базами и выгруженными файлами XML.</font></strong></p>
<p class="Usual"></p>
<p class="Usual"><font size="2"><u></u></font> </p>
<p class="Usual"><font size="2"><u>Для работы с файловой базой необходимо заполнить следующие параметры и настройки:</u></font> </p>
<p class="Usual"><font size="2">* Путь к базе - строка подключения к текущей базе.</font></p>
<p class="Usual"><font size="2">* Пользователь - пользователь под которым запущено предприятие.</font></p>
<p class="Usual"><font size="2">* Пароль - пароль к текущей базе.</font></p>
<p class="Usual"><font size="2">* Загрузить основную конфигурацию из файлов XML - загружает в конфигурацию файлы XML после выполнения автоформатирования кода и локализации элементов форм.</font></p>
<p class="Usual"><font size="2">* Обновить конфигурацию базы данных после загрузки файлов XML - принимает изменения в конфигурации после загрузки файлов XML.</font></p>
<p class="Usual"><font size="2">* Каталог хранилища - строка подключения к каталогу хранилища базы.</font></p>
<p class="Usual"><font size="2">* Пользователь хранилища - пользователь хранилища для текущей базы.</font></p>
<p class="Usual"><font size="2">* Пароль хранилища - пароль хранилища текущей базы.</font></p>
<p class="Usual"></p><font size="2">
<p class="Usual"><font size="2">* Помещать измененные объекты в хранилище - помещает измененные объекты в хранилище, если оно указано.</font></p>
<p class="Usual"> </p></font>
<p class="Usual"><font size="2"><u>Для работы с серверной базой необходимо заполнить следующие параметры и настройки:</u></font></p>
<p class="Usual"><font size="2">* Кластер серверов 1с: Предприятия - кластер серверов текущей базы.</font></p>
<p class="Usual"><font size="2">* Имя информационной базы в кластере - имя текущей базы в кластере серверов.</font></p>
<p class="Usual"><font size="2">* Пользователь - пароль к текущей базе.</font></p>
<p class="Usual"><font size="2">* Пароль - пароль к текущей базе.</font></p>
<p class="Usual"><font size="2">* Загрузить конфигурацию базы данных из файлов XML - загружает в конфигурацию файлы XML после выполнения автоформатирования кода и локализации элементов формы.</font></p>
<p class="Usual"><font size="2">* Обновить конфигурацию базы данных после загрузки файлов XML - принимает изменения в конфигурации после загрузки файлов XML.</font></p>
<p class="Usual"><font size="2">* Каталог хранилища - строка подключения к каталогу хранилища базы.</font></p>
<p class="Usual"><font size="2">* Пользователь хранилища - пользователь хранилища для текущей базы.</font></p>
<p class="Usual"><font size="2">* Пароль хранилища - пароль хранилища текущей базы.</font></p>
<p class="Usual"><font size="2">* Помещать измененные объекты в хранилище - помещает измененные объекты в хранилище, если оно указано.</font></p>
<p class="Usual"></p>
<p class="Usual"><font size="2"><u></u></font> </p>
<p class="Usual"><font size="2"><u>Для работы с выгрузкой XML необходимо заполнить следующие параметры и настройки:</u></font></p>
<p class="Usual"><font size="2">* Каталог выгрузки файлов XML - путь, по которому расположены XML файлы выгрузки конфигурации.</font></p>
<p class="Usual"><font size="1"></font></p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Содержит команды:</font></strong></p>
<p class="Usual"><font size="2">- Выполнить автоформатирование кода и локализацию элементов форм - при нажатии происходит автоформатирование кода и локализация элементов формы к выбранным стандартам.</font></p>
<p class="Usual"><font size="2">- Выполнить анализ изменений - при нажатии происходит анализ изменений в коде. Можно посмотреть сравнение файлов до автоформатирования кода и локализации элементов формы и после. При этом откроется дополнительная форма для анализа изменений, в которой есть команда:</font></p>
<p class="Usual"><font size="2">- Загрузить выбранные файлы - при нажатии происходит загрузка в конфигурацию измененных файлов, отмеченных флажками.</font></p>
<p class="Usual"><font size="2"><strong></strong></font></p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Приводит конфигурацию к стандартам (*), в т.ч. исправляет следующие виды ошибок (**):</font></strong></p>
<p class="Usual"><font size="2">* 437. Оформление текстов запросов<br>  ** Приведение ключевых слов запроса в канонический вид (п. 1)</font></p><font size="2">
<p class="Usual"><br>* 441. Общие требования к построению конструкций встроенного языка<br>  ** Приведение ключевых слов встроенного языка в канонический вид (п. 1)</p>
<p class="Usual"><br>* 455. Структура модуля<br>  ** Перевод разделов модулей в виде комментариев в области в виде "#Область" (п. 1.3)<br>  ** Удаление пустых областей (п. 1.8)<br>  ** Добавление раздела "#Область ОписаниеПеременных" (п. 2.2)<br>  ** Добавление раздела "#Область Инициализация" (п. 2.7)</p>
<p class="Usual"><br>* 456. Тексты модулей<br>  ** Установка в крайнюю левую позицию описаний процедур и функций, директив компилятора, инструкций препроцессора и т.д. (п. 5.1)<br>  ** Перенос комментариев длиннее 120-ти символов (п. 6)<br>  ** Перевод в верхний регистр первой буквы длинных комментариев (п. 7.3)<br>  ** Добавление пробела в начале комментариев (п. 7.3)</p>
<p class="Usual"><br>* 467. Общие требования к конфигурации<br>  ** Сортировка объектов метаданных верхнего уровня (п. 2.3)</p>
<p class="Usual"> </p>
<p class="Usual">* 478. Подсказка и проверка заполнения<br>  ** Очистка подсказок, совпадающих с синонимом, у реквизитов, измерений, ресурсов и т.п. (п. 1)</p>
<p class="Usual"> </p>
<p class="Usual">* 680. Поддержка толстого клиента, управляемое приложение, клиент-сервер<br>  ** Заключение кода в инструкцию препроцессора (п.2)</p>
<p class="Usual"><br>* 762. Запросы, динамические списки и отчеты на СКД: требования по локализации<br>  ** Заполнение заголовков колонок динамического списка, получающихся в запросе комбинацией других колонок и имеющих свой псевдоним (п. 3)</p>
<p class="Usual"><br>* 765. Элементы форм: требования по локализации<br>  ** Заполнение заголовков у всех групп и таблиц на формах (п. 2)<br>  ** Очистка бессмысленных подсказок у групп форм (п. 3)</p>
<p class="Usual"><br>* 767. Регламентные задания: требования по локализации<br>  ** Очистка наименований предопределенных регламентных заданий (п. 1)</p></font>
<p class="Usual"></p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Программный вызов.</font></strong></p>
<p class="Usual"><strong></strong> </p>
<p class="Usual"><font size="2">Автоформатирование кода модулей и локализацию элементов форм можно вызывать программно. Для этого необходимо программно создать внешнюю обработку в коде конфигурации или встроить ее в саму конфигурацию и вызвать функцию "АвтоформатироватьКод()" из модуля объекта обработки.</font></p>
<p class="Usual"><font size="2">В функцию "АвтоформатироватьКод()" можно передать параметр "ПараметрыАвтоформатирования", являющийся структурой.</font></p>
<p class="Usual"><font size="2">Если параметр не передан, то он заполнится по умолчанию. Параметр можно получить заранее с помощью функции "ПолучитьПараметрыАвтоформатированияПоУмолчанию()" также из модуля объекта обработки и заполнить его на свое усмотрение.</font></p>
<p class="Usual"><font size="2">Ключи параметра "ПараметрыАвтоформатирования":</font></p>
<p class="Usual"><font size="2">* ПутьКБазе - по умолчанию заполняется строкой подключения к текущей базе, можно указать любую другую базу, передав строку подключения или каталог базы;</font></p>
<p class="Usual"><font size="2">* Пользователь - по умолчанию заполняется текущим пользователем, под которым запущено предприятие;</font></p>
<p class="Usual"><font size="2">* Пароль - по умолчанию заполняется пустой строкой;</font></p>
<p class="Usual"><font size="2">* КаталогВыгрузкиXML - по умолчанию заполняется каталогом временных файлов;</font></p>
<p class="Usual"><font size="2">* ОбновитьКонфигурациюБД - по умолчанию заполняется значением "Ложь";</font></p>
<p class="Usual"><font size="2">* КаталогХранилища - по умолчанию заполняется пустой строкой - если значение ключа не заполнено, обновление из хранилища выполняться не будет;</font></p>
<p class="Usual"><font size="2">* ПользовательХранилища - по умолчанию заполняется пустой строкой;</font></p>
<p class="Usual"><font size="2">* ПарольХранилища - по умолчанию заполняется пустой строкой;</font></p>
<p class="Usual">* ПомещатьИзмененныеОбъектыВХранилище - по умолчанию заполняется значением "Ложь";</p>
<p class="Usual"><font size="2">* СтрокаЗапускаПлатформы - по умолчанию заполняется значением пути к исполняемому файлу платформы: КаталогПрограммы() + "1cv8.exe";</font></p>
<p class="Usual"><font size="2">* СписокИзмененныхОбъектов - по умолчанию заполняется временным файлом с расширением xml. Параметр используется для создания списка измененных объектов в результате автоформатирования кода и локализации элементов форм.</font></p>
<p class="Usual">Объекты записываются в файл со следующими атрибутами:</p>
<p class="Usual"> - fullName - заполняется значением полного пути к объекту конфигурации;</p>
<p class="Usual"> - includeChildObjects - по умолчанию заполняется значением false.</p>
<p class="Usual">Данный список используется для загрузки измененных объектов конфигурации в хранилище в пакетном режиме с ключом "/ConfigurationRepositoryCommit" (подробнее см. в справке).</p>
<p class="Usual">* ВыгружатьКонфигурациюВФайлыXML - по умолчанию заполняется значением "Истина", от значения этого параметра зависит, будет происходить работа с ИБ (если Истина) или с каталогом "КаталогВыгрузкиXML" (если Ложь);</p>
<p class="Usual">* ЗагружатьКонфигурациюИзФайловXML - по умолчанию заполняется значением "Истина"; </p>
<p class="Usual"><font size="2">* ТекстКомментария - по умолчанию заполняется пустой строкой - текст комментария, который добавляется в историю хранилища при помещении очередной порции измененных объектов в хранилище;</font></p>
<p class="Usual">* СписокЗахваченныхОбъектов - по умолчанию заполняется пустой строкой - путь к файлу со списком захваченных объектов в хранилище, как правило, указывается, если объекты уже захвачены в хранилище до запуска обработки автоформатирования и локализации;</p>
<p class="Usual"><font size="2">* ЗначениеФлагов - структура - по умолчанию заполняется стандартами из макета "СтандартыРазработки":</font></p>
<p class="Usual">ключ структуры - строка - значение из колонки "Ключ" в макете "СтандартыРазработки",</p>
<p class="Usual"><font size="2">значение структуры - булево - для каждого стандарта и вида ошибок устанавливается значение "Истина" или "Ложь": "Истина" соответствует ячейке в колонке "ВыбранПоУмолчанию", заполненной любым значением; если ячейка пустая, то для стандарта или ошибки по умолчанию будет установлено значение "Ложь"</font><font size="2">.</font></p>
<p class="Usual">Если для стандарта указано значение "Ложь", то он будет пропущен целиком (сам стандарт и его ошибки) при работе обработки, вне зависимости от значений ошибок, входящих в этот стандарт.</p>
<p class="Usual">Если для ошибки стандарта указано значение "Ложь", то ее исправление будет пропущено, вне зависимости от значения стандарта, в который она входит.</p>
<p class="Usual"><font size="2">По умолчанию значения для стандартов и ошибок (по умолчанию "Истина") берутся из макета, однако, их можно задать программно, например, предварительно получив всю структуру стандартов и ошибок с помощью функции ПолучитьЗначенияФлаговПоУмолчанию(). Затем для стандартов и ошибок, которые исправлять не требуется, можно установить значение "Ложь".</font></p>
<p class="Usual"> </p>
<p class="Usual"><font size="2">Возвращаемое значение функции "АвтоформатироватьКод()": строка - сообщение об ошибке на любом из этапов по порядку:</font></p>
<p class="Usual"><font size="2">- работа с хранилищем (выполняется, если заполнено значение ключа "КаталогХранилища" у параметра "ПараметрыАвтоформатирования"):</font></p>
<p class="Usual"><font size="2">  -- загрузка конфигурации из хранилища (если "ПомещатьИзмененныеОбъектыВХранилище" = Ложь);</font></p>
<p class="Usual">  или</p>
<p class="Usual">  -- подключение к хранилищу и захват объектов (если "ПомещатьИзмененныеОбъектыВХранилище" = Истина);</p>
<p class="Usual"><font size="2">- выгрузка модулей (выполняется, если значение ключа "ВыгружатьКонфигурациюВФайлыXML" = Истина);</font></p>
<p class="Usual"><font size="2">- загрузка модулей (выполняется, если значение ключа "ЗагружатьКонфигурациюИзФайловXML" = Истина);</font></p>
<p class="Usual"><font size="2">- обновление конфигурации в базе данных (принятие изменений) (выполняется, если значение ключа "ОбновитьКонфигурациюБД" = "Истина");</font></p>
<p class="Usual">- помещение измененных объектов в хранилище (выполняется, если значение ключа "ПомещатьИзмененныеОбъектыВХранилище" = Истина).</p>
<p class="Usual"><font size="2">Если один из этапов завершился с ошибкой, то остальные этапы выполняться не будут.</font></p>
<p class="Usual"><font size="2">Если все этапы выполнились успешно, функция "АвтоформатироватьКод()" вернет пустую строку.</font></p>
<p class="Usual"><font size="2"></font></p>
<p class="Usual"><font size="2">При программном вызове автоформатирования кода модулей и локализации элементов форм все действия производятся на сервере, поэтому никаких сообщений пользователю выводиться не будет.</font></p>
<p class="Usual"><font size="2">При интерактивном автоформатировании кода модулей и локализации элементов форм пользователю выводятся все сообщения об удачном или неудачном действии (например, выгрузка конфигурации в файлы XML), а также устанавливается состояние, в котором виден прогресс форматирования модулей.</font></p>
<p class="Usual"><font size="2"></font></p>
<p class="Usual"><font size="2">Стоит понимать, что вызвав программно функцию "АвтоформатироватьКод()" без указания параметра "ПараметрыАвтоформатирования" (как уже сказано выше, в самой функции он автоматически заполнится по умолчанию), предполагается следующее поведение: </font></p>
<p class="Usual"><font size="2">- обновление конфигурации из хранилища не произойдет, </font></p>
<p class="Usual"><font size="2">- конфигурация будет приведена к перечисленным выше стандартам в текущей базе под текущим пользователем с пустым паролем (!), </font></p>
<p class="Usual"><font size="2">- исправленные модули и файлы XML будут загружены в базу, но конфигурация обновлена не будет (изменения не будут приняты).</font></p>
<p class="Usual"><font size="2">Если у текущего пользователя БД есть пароль, то функция "АвтоформатироватьКод()" вернет ошибку на этапе выгрузки файлов XML, автоформатирования не произойдет.</font></p></font></body></html>