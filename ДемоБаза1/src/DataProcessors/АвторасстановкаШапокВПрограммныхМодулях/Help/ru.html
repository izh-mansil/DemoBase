<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html;charset=utf-8" http-equiv="content-type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.16428"></meta></head><body><font size="2">
<p class="Usual"><strong><font size="3">Обработка предназначена для автоматической вставки текста в начало всех программных модулей.</font></strong></p>
<p class="Usual"></p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Работает с файловыми базами, серверными базами и выгруженными файлами XML.</font></strong></p>
<p class="Usual"></p>
<p class="Usual"><font size="2"><u></u></font> </p>
<p class="Usual"><font size="2"><u>Для работы с файловой базой необходимо заполнить следующие параметры и настройки:</u></font> </p>
<p class="Usual"><font size="2">* Путь к базе - строка подключения к текущей базе.</font></p>
<p class="Usual"><font size="2">* Пользователь - пользователь под которым запущено предприятие.</font></p>
<p class="Usual"><font size="2">* Пароль - пароль к текущей базе.</font></p>
<p class="Usual"><font size="2">* Загрузить основную конфигурацию из файлов XML - загружает в конфигурацию файлы XML после выполнения автоформатирования кода и локализации элементов форм.</font></p>
<p class="Usual"><font size="2">* Обновить конфигурацию базы данных после загрузки файлов XML - принимает изменения в конфигурации после загрузки файлов XML.</font></p>
<p class="Usual"><font size="2">* Каталог хранилища - строка подключения к каталогу хранилища базы.</font></p>
<p class="Usual"><font size="2">* Пользователь хранилища - пользователь хранилища для текущей базы.</font></p>
<p class="Usual"><font size="2">* Пароль хранилища - пароль хранилища текущей базы.</font></p>
<p class="Usual"></p><font size="2">
<p class="Usual"><font size="2">* Помещать измененные объекты в хранилище - помещает измененные объекты в хранилище, если оно указано.</font></p>
<p class="Usual"> </p></font>
<p class="Usual"><font size="2"><u>Для работы с серверной базой необходимо заполнить следующие параметры и настройки:</u></font></p>
<p class="Usual"><font size="2">* Кластер серверов 1с: Предприятия - кластер серверов текущей базы.</font></p>
<p class="Usual"><font size="2">* Имя информационной базы в кластере - имя текущей базы в кластере серверов.</font></p>
<p class="Usual"><font size="2">* Пользователь - пароль к текущей базе.</font></p>
<p class="Usual"><font size="2">* Пароль - пароль к текущей базе.</font></p>
<p class="Usual"><font size="2">* Загрузить конфигурацию базы данных из файлов XML - загружает в конфигурацию файлы XML после выполнения автоформатирования кода и локализации элементов формы.</font></p>
<p class="Usual"><font size="2">* Обновить конфигурацию базы данных после загрузки файлов XML - принимает изменения в конфигурации после загрузки файлов XML.</font></p>
<p class="Usual"><font size="2">* Каталог хранилища - строка подключения к каталогу хранилища базы.</font></p>
<p class="Usual"><font size="2">* Пользователь хранилища - пользователь хранилища для текущей базы.</font></p>
<p class="Usual"><font size="2">* Пароль хранилища - пароль хранилища текущей базы.</font></p>
<p class="Usual"><font size="2">* Помещать измененные объекты в хранилище - помещает измененные объекты в хранилище, если оно указано.</font></p>
<p class="Usual"></p>
<p class="Usual"><font size="2"><u></u></font> </p>
<p class="Usual"><font size="2"><u>Для работы с выгрузкой XML необходимо заполнить следующие параметры и настройки:</u></font></p>
<p class="Usual"><font size="2">* Каталог выгрузки файлов XML - путь, по которому расположены XML файлы выгрузки конфигурации.</font></p>
<p class="Usual"><font size="1"></font></p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Содержит команды:</font></strong></p>
<p class="Usual"><font size="2">- Выполнить авторасстановку текста-преамбулы в программные модули - при нажатии происходит вставка подготовленного текста в начало модулей конфигурации.</font></p>
<p class="Usual"><font size="2">- Выполнить анализ изменений - при нажатии происходит анализ изменений в коде. Можно посмотреть сравнение файлов до вставки текста и после. При этом откроется дополнительная форма для анализа изменений, в которой есть команда:</font></p>
<p class="Usual"><font size="2">- Загрузить выбранные файлы - при нажатии происходит загрузка в конфигурацию измененных файлов, отмеченных флажками.</font></p>
<p class="Usual"><font size="2"><strong></strong></font></p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Программный вызов.</font></strong></p>
<p class="Usual"><strong></strong> </p>
<p class="Usual"><font size="2">Обработку можно вызывать программно. Для этого необходимо программно создать внешнюю обработку в коде конфигурации или встроить ее в саму конфигурацию и вызвать функцию "АвтоформатироватьКод()" из модуля объекта обработки.</font></p>
<p class="Usual"><font size="2">В функцию "АвтоформатироватьКод()" можно передать параметр "ПараметрыАвтоформатирования", являющийся структурой.</font></p>
<p class="Usual"><font size="2">Если параметр не передан, то он заполнится по умолчанию. Параметр можно получить заранее с помощью функции "ПолучитьПараметрыАвтоформатированияПоУмолчанию()" также из модуля объекта обработки и заполнить его на свое усмотрение.</font></p>
<p class="Usual"><font size="2">Ключи параметра "ПараметрыАвтоформатирования":</font></p>
<p class="Usual"><font size="2">* ПутьКБазе - по умолчанию заполняется строкой подключения к текущей базе, можно указать любую другую базу, передав строку подключения или каталог базы;</font></p>
<p class="Usual"><font size="2">* Пользователь - по умолчанию заполняется текущим пользователем, под которым запущено предприятие;</font></p>
<p class="Usual"><font size="2">* Пароль - по умолчанию заполняется пустой строкой;</font></p>
<p class="Usual"><font size="2">* КаталогВыгрузкиXML - по умолчанию заполняется каталогом временных файлов;</font></p>
<p class="Usual"><font size="2">* ОбновитьКонфигурациюБД - по умолчанию заполняется значением "Ложь";</font></p>
<p class="Usual"><font size="2">* КаталогХранилища - по умолчанию заполняется пустой строкой - если значение ключа не заполнено, обновление из хранилища выполняться не будет;</font></p>
<p class="Usual"><font size="2">* ПользовательХранилища - по умолчанию заполняется пустой строкой;</font></p>
<p class="Usual"><font size="2">* ПарольХранилища - по умолчанию заполняется пустой строкой;</font></p>
<p class="Usual">* ПомещатьИзмененныеОбъектыВХранилище - по умолчанию заполняется значением "Ложь";</p>
<p class="Usual"><font size="2">* СтрокаЗапускаПлатформы - по умолчанию заполняется значением пути к исполняемому файлу платформы: КаталогПрограммы() + "1cv8.exe";</font></p>
<p class="Usual"><font size="2">* СписокИзмененныхОбъектов - по умолчанию заполняется временным файлом с расширением xml. Параметр используется для создания списка измененных объектов в результате автоформатирования кода и локализации элементов форм.</font></p>
<p class="Usual">Объекты записываются в файл со следующими атрибутами:</p>
<p class="Usual"> - fullName - заполняется значением полного пути к объекту конфигурации;</p>
<p class="Usual"> - includeChildObjects - по умолчанию заполняется значением false.</p>
<p class="Usual">Данный список используется для загрузки измененных объектов конфигурации в хранилище в пакетном режиме с ключом "/ConfigurationRepositoryCommit" (подробнее см. в справке).</p>
<p class="Usual">* ВыгружатьКонфигурациюВФайлыXML - по умолчанию заполняется значением "Истина", от значения этого параметра зависит, будет происходить работа с ИБ (если Истина) или с каталогом "КаталогВыгрузкиXML" (если Ложь);</p>
<p class="Usual">* ЗагружатьКонфигурациюИзФайловXML - по умолчанию заполняется значением "Истина"; </p>
<p class="Usual"><font size="2">* ТекстКомментария - по умолчанию заполняется пустой строкой - текст комментария, который добавляется в историю хранилища при помещении очередной порции измененных объектов в хранилище;</font></p>
<p class="Usual">* СписокЗахваченныхОбъектов - по умолчанию заполняется пустой строкой - путь к файлу со списком захваченных объектов в хранилище, как правило, указывается, если объекты уже захвачены в хранилище до запуска обработки автоформатирования и локализации;</p>
<p class="Usual">* ТекстПреамбулыПрограммныхМодулей - по умолчанию заполняется текстом из макета "ШаблонТекстаПреамбулы" - текст для вставки в модули конфигурации.</p>
<p class="Usual">Пример:</p>
<p class="Usual">///////////////////////////////////////////////////////////////////////////////////////////////////////<br>// Copyright (c) %Год%, ООО 1С-Софт<br>///////////////////////////////////////////////////////////////////////////////////////////////////////</p>
<p class="Usual"><font size="2">где %Год% является параметром и заменяется текущим годом.</font></p>
<p class="Usual"> </p>
<p class="Usual"><font size="2">Возвращаемое значение функции "АвтоформатироватьКод()": строка - сообщение об ошибке на любом из этапов по порядку:</font></p>
<p class="Usual"><font size="2">- работа с хранилищем (выполняется, если заполнено значение ключа "КаталогХранилища" у параметра "ПараметрыАвтоформатирования"):</font></p>
<p class="Usual"><font size="2">  -- загрузка конфигурации из хранилища (если "ПомещатьИзмененныеОбъектыВХранилище" = Ложь);</font></p>
<p class="Usual">  или</p>
<p class="Usual">  -- подключение к хранилищу и захват объектов (если "ПомещатьИзмененныеОбъектыВХранилище" = Истина);</p>
<p class="Usual"><font size="2">- выгрузка модулей (выполняется, если значение ключа "ВыгружатьКонфигурациюВФайлыXML" = Истина);</font></p>
<p class="Usual"><font size="2">- загрузка модулей (выполняется, если значение ключа "ЗагружатьКонфигурациюИзФайловXML" = Истина);</font></p>
<p class="Usual"><font size="2">- обновление конфигурации в базе данных (принятие изменений) (выполняется, если значение ключа "ОбновитьКонфигурациюБД" = "Истина");</font></p>
<p class="Usual">- помещение измененных объектов в хранилище (выполняется, если значение ключа "ПомещатьИзмененныеОбъектыВХранилище" = Истина).</p>
<p class="Usual"><font size="2">Если один из этапов завершился с ошибкой, то остальные этапы выполняться не будут.</font></p>
<p class="Usual"><font size="2">Если все этапы выполнились успешно, функция "АвтоформатироватьКод()" вернет пустую строку.</font></p>
<p class="Usual"><font size="2"></font></p>
<p class="Usual"><font size="2">При программном вызове обработки все действия производятся на сервере, поэтому никаких сообщений пользователю выводиться не будет.</font></p>
<p class="Usual"><font size="2">При интерактивном использовании обработки пользователю выводятся все сообщения об удачном или неудачном действии (например, выгрузка конфигурации в файлы XML), а также устанавливается состояние, в котором виден прогресс форматирования модулей.</font></p>
<p class="Usual"><font size="2"></font></p>
<p class="Usual"><font size="2">Стоит понимать, что вызвав программно функцию "АвтоформатироватьКод()" без указания параметра "ПараметрыАвтоформатирования" (как уже сказано выше, в самой функции он автоматически заполнится по умолчанию), предполагается следующее поведение: </font></p>
<p class="Usual"><font size="2">- обновление конфигурации из хранилища не произойдет, </font></p>
<p class="Usual"><font size="2">- конфигурация будет приведена к перечисленным выше стандартам в текущей базе под текущим пользователем с пустым паролем (!), </font></p>
<p class="Usual"><font size="2">- исправленные модули и файлы XML будут загружены в базу, но конфигурация обновлена не будет (изменения не будут приняты).</font></p>
<p class="Usual"><font size="2">Если у текущего пользователя БД есть пароль, то функция "АвтоформатироватьКод()" вернет ошибку на этапе выгрузки файлов XML, вставки текста в модули не произойдет.</font></p></font></body></html>